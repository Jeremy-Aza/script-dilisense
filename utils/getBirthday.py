import re
from datetime import datetime
import pandas as pd

# Lista cruda de entradas con nombre y RFC
raw_data = """
AXTEL	AXT940727FP8
COLTOMEX	COL130513JE1
PISA SOFTWARE	PSO050909U77
CRECIMIENTO CREATIVO	CCR200924QK9
CONCANACO SERVYTUR DE EUM	CCN410502K12
INSTITUTO MEXICANO DEL SEGURO SOCIAL	IMS421231I45
MITHAPPEN	MIT230116RU8
GUIOT GUTIERREZ Y ASOCIADOS	GGA130510EN6
ROCHA MENDOZA CONSULTING	RMC090212C24
JORGE  ZÚÑIGA RODRIGUEZ	ZURJ790114RX9
FRANCO COMUNICACIONES SC	FCO990121M13
MYCARD, S.A. DE C.V.	MYC000113M62
TECNOCEN.COM	TEC101101M54
ACCOUNTING GROUP ADR AND ASSOCIATES	AGA1911079T3
SECURREY PROTECTS SEGURIDAD PRIVADA	SPS230314NB7
CONSULTORIA Y SERVICIOS ESPECIALIZADOS CRCJ S DE RL DE CV	CSE210617TS4
EMEDF CONSULTING GROUP	MFL040730I53
SI VALE MEXICO SA DE CV	PUN9810229R0
HERMILO SANTIAGO NARVAEZ ARANCIBIA	NAAH440113M10
GIL PATENTES Y MARCAS	GPM840203479
GUVI TOURS S.A DE C.V	GTO930224TH9
INSTITUTO DEL FONDO NACIONAL DE LA VIVIENDA PARA LOS TRABAJADORES	INF7205011ZA
SALVADOR RUIZ	SRU220704N17
TEKNEI SA DE CV	TEK100312RV3
CONSULTORIA INTEGRAL GFV, S.C.	CIG191030GE4
BIT PAY	BPA1903127A3
CENTRALDEREDES.IO	CEN231128RGA
TELEFONOS DE MEXICO	TME840315KT6
CSJAGUAR S.A DE C.V	CSJ1804044B6
DUN & BRADSTREET DE MEXICO	DBM961028GG7
RUSSELL BEDFORD MÉXICO, S.C.	RBM930301Q83
SISTEMA DE TRANSFERENCIAS Y PAGOS STP, SA DE CV, INSTITUCION DE FONDOS DE PAGO ELECTRONICO	STP081030FE6
ERNESTO EMILIO MONTOYA TERRAZAS	MOTE730912582
OTERCES CONSULTORES DE MEXICO	OCM1104132R1
HEWLETT-PACKARD MEXICO	HME871101RG3
COMISION NACIONAL PARA LA PROTECCION Y DEFENSA DE LOS USUARIOS DE SERVICIOS FINANCIEROS	CNP990419B40
GERARDO GONZALEZ MEZA HOFFMANN	GOHG790930K70
JAROS CAPITAL ASESOR INDEPENDIENTE	JCA170316E3A
TUEMPRESAFACIL.COM	TCO140219T52
BBVA MEXICO, S.A., INSTITUCION DE BANCA MULTIPLE, GRUPO FINANCIERO BBVA MEXICO.	BBA830831LJ2
PEDRO DAVID MORALES MENDEZ	MOMP9901268D0
GUILLERMO CARRANCO ROMERO	CARG7803153G2
LUIS ANTONIO MONTES DE OCA MAYAGOITIA	MOML621203SC4
FONG CONSULTORES Y ASOCIADOS	FCA160706KQ3
AAFEJ	AAF190319CU1
SERVICIOS LINBEL	SLI2211232V7
EMPRESAS MANADEX	EMA090701E12
GUZTAVO VALLE PEREZ	VAPG990218PR2
APPLE OPERATIONS MÉXICO, S.A. DE C.V.	AOM920820BEA
CHINA MARKET COMPANY	CMA1905169Y6
GRUPO RADIOFONICO DE GUANAJUATO SA DE CV	GRG1305119S0
CREATIVIDAD Y ESPECTACULOS S.A. DE C.V.	CES010717LKA
CAPITALI GRUPO HOTELERO SA DE CV	CGH181204IW0
GOBIERNO DE LA CIUDAD DE MÉXICO	GDF9712054NA
BUSINESS TRAVEL LIFE, SA DE CV	BTL1306202J0
RADIOMOVIL DIPSA	RDI841003QJ4
LUIS SARABIA LOPEZ	SALL690126TU9
GRISELDA HERNANDEZ REYES	HERG840616MH7
TE OPERA SAPI DE CV	TOP1705169U6
SUPER FAR ECATEPEC SA DE CV	SFE150622FM5
LABORATORIO MEDICO UNIVERSIDAD S.A. DE C.V.	LMU010112UV5
SUPER FAR IZCALLI SA DE CV	SFI150622T16
ABRAHAM LOPEZ FRAZCO	LOFA591231CZA
CFE SUMINISTRADOR DE SERVICIOS BASICOS	CSS160330CP7
SERVICIO DIAMANTE	SDI011023GL8
HOTEL SPA FLAMINGOS ACAPULCO, S.A. DE C.V.	HSF1304197T9
ISRAEL MARTINEZ PANTOJA	MAPI740725790
LA CALLE DEL VINO S.A. DE C.V.	CVI010928E14
LORENA DIAZ ARIAS	DIAL900625KF4
DORA LUCIA PONCE SALAS	POSD720403NA7
LA FAMILIA 100% SA DE CV	FCC961213NC6
PROGRAMAS PARA DIGITALIZACION DE EMPRESAS	PDE2103097J6
PAITITI DEL MAR SA DE CV	PMA170203CS2
CASA DE BOLSA FINAMEX	CBF920629BV0
OSCAR NOE GARCIA SANDOVAL	GASO710831BS7
RESTAURANTES TOKS, S.A. DE C.V.	RTO840921RE4
SERVICIO CIMOVI SA DE CV	SCI000810Q79
100% NATURAL AEROPUERTO SA DE CV	CNA0505258A0
DHL EXPRESS MEXICO	DEM8801152E9
PASE, SERVICIOS ELECTRONICOS, S.A. DE C.V.	ISD950921HE5
BANCO AZTECA SA INSTITUCION DE BANCA MULTIPLE	BAI0205236Y8
GOBIERNO DEL ESTADO DE OAXACA	GEO621201KIA
CAMARA NACIONAL DE COMERCIO SERVICIOS Y TURISMO DE ACAPULCO	CNC240731TU4
PAULITA PÉREZ JULIO	PEJP800125FQ6
GEORGINA ARACELI LOPEZ MARTINEZ	LOMG8507073M0
PAGO EXPRESS SERVICIOS PREPAGADOS	PES090417FVA
MELANDAS PAYMENTS	MPA170217FB1
OPERADORA DE RESTAURANTES LA FOGATA, S.A. DE C.V.	ORF960226PK8
AUTOPISTAS DE GUERRERO, S.A. DE C.V.	AGU910620RZ8
ABASTECEDORA LUMEN	ALU830902ST5
ALIMENTOS LEPE S.A. DE C.V.	ALE891213RPA
CAMARA NACIONAL DE COMERCIO SERVICIOS Y TURISMO DE TAPACHULA	CNC1105246L4
TE DOY RIDE SA DE CV	TDR140207PD3
HUGO JIMENEZ ANDRES	JIAH870710EJ3
JOSE DE LA CRUZ JARDON	CUJJ651014333
JOSE LUIS JORGE ESPINOZA CERDA	EICL7707122Q5
CECILIA NAVARRETE JIMENEZ	NAJC7711096L3
ANA LILIA AGUILAR NUÑEZ	AUNA730803GL8
OPERADORA DE FRANQUICIAS DINEEK SA DE CV	OFD1509177N8
MISRAIN SEVILLA MARIN	SEMM770210M1A
RICARDO GAYTAN HERNANDEZ	GAHR760310C11
JOSE ENRIQUE VERA MARTINEZ	VEME8107154Y4
DAVID ANTONIO PRADO RODRIGUEZ	PARD780809KP2
DESARROLLO GLOBAL DE CONCESIONES, S.A. DE C.V.	DGC170313257
GESTO PAGO DE SERVICIOS	GPS110920S7A
LISBOA BANANAS	LBA110627G82
HINO MOTORS SALES MÉXICO, S.A. DE C.V.	HMS0701119P8
JOSÉ JAVIER BERNAL SANTIAGO	BESJ830413NH7
MELANDAS PAYMENTS	MPA170217FB1
CESAR LOPEZ MUÑOZ	LOMC6607232L6
MARIA ELENA MACIEL DIEGO	MADE8405223T3
SERGIO RICARDO ALVAREZ LEDESMA	AALS670323SY0
SERGIO VALLEJO FUENTES	VAFS620919HK7
FERNANDA ESCAREÑO GARCIA	EAGF910617DJ6
DIANA SANCHEZ HEREDIA	SAHD8608051L9
JOSE LUIS BLANDO CAMPOS	BACL7112304K8
ADRIANA IVETTE DELGADO ZUÑIGA	DEZA820901J25
GUSTAVO TAPIA RAMIREZ	TARG650116RVA
RIGOBERTO MEJIA GUIZAR	MEGR720101G17
DIEGO VALLEJO MUÑOZ	VAMD9408221V1
CARLOS SAMUEL FIGUEROA MERCADO	FIMC841104M66
JESUS ROMERO BARRERA	ROBJ680410PH9
GIOVANNI ROBERTO POMPA GARCIA	POGG901020EQ9
EFREN MALDONADO BRAVO	MABE8512023X8
YANET GOMEZ RIOS	GORY800903AJ3
LUIS FERNANDO ARANA DIAZ	AADL890731LK2
JUAN MANUEL MITCHELL ESCUTIA HERAZ	EUHJ950927UG7
JOSE CARLOS PAUL VAZQUEZ DAMIAN	VADC880320VC6
GERARDO TADEO MATÍAS BERMUDEZ	MABG910715E81
JOCELYN CECILIA SALINAS NAVARRO	SANJ940923L31
ARTURO RENTERIA CORDOVA	RECA790813PQ4
KARINA MALINALLI REYES ROBLEDO	RERK980704NR7
TOMAS GERARDO IGNACIO ARRIOLA SANCHEZ	AIST650104687
YOLANDA RODRIGUEZ RODRIGUEZ	RORY9812147D8
AIDA SELENE ISLAS ALVARADO	IAAA760312432
MARCELINO VALDEZ MONROY	VAMM700829EF5
JUAN CARLOS COTIJA GARCIA	COGJ950809CJA
HECTOR HUGO CONTRERAS SIERRA	COSH711123BG6
CARLOS ADONIS ARGUELLES MORALES	AUMC9603293L3
FRANCISCO ALVAREZ CERVANTES	AACF670406PX0
ALEJANDRA JUAREZ URIBE	JUUA9011287Z9
CASANDRA AMAIRANI SALINAS RODRIGUEZ	SARC950724IL0
SELENNE GARCÍA TAPIA	GATS730510KF6
JULIO CESAR MONZON MORENO	MOMJ730122K42
ERICK RICARDO MAYO PEREZ	MAPE870621FXA
IVAN YAEL ORTIZ LOPEZ	OILI970715G9A
"""

# Procesar cada línea para extraer nombre y RFC
data = []
for line in raw_data.strip().split("\n"):
    parts = line.strip().split("\t")
    if len(parts) == 2:
        name, rfc = parts
        # Extraer los 6 dígitos centrales del RFC (AAMMDD)
        match = re.search(r'([A-ZÑ&]{3,4})(\d{6})', rfc)
        if match:
            date_part = match.group(2)
            try:
                # Determinar el siglo para años de 2 dígitos
                year = int(date_part[:2])
                if year >= 0 and year <= 25:
                    century = 2000
                else:
                    century = 1900
                birth_date = datetime.strptime(f"{century + year}{date_part[2:]}", "%Y%m%d").date()
                data.append((name, rfc, str(birth_date)))
            except ValueError:
                data.append((name, rfc, "Fecha inválida"))
        else:
            data.append((name, rfc, "RFC no válido"))
    else:
        data.append((line.strip(), "", "Formato inválido"))

# Crear DataFrame
df = pd.DataFrame(data, columns=["Nombre", "RFC", "Fecha de nacimiento"])
df.head(70)


df.to_csv("rfc_fechas.csv", index=False)